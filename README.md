# wei-template-workcell

This is a template Workcell repository for the [Workcell Execution Interface](https://github.com/AD-SDL/wei).

## Dependencies

- This template uses GNU make and a handful of makefiles for configuration and as a command runner. You can run `make help` for a complete list of supported `make` commands and a brief description of what they do.
- You'll need [docker installed](https://docs.docker.com/engine/install/)
    - Make sure to follow the [post installation steps](https://docs.docker.com/engine/install/linux-postinstall/) to enable non-root user access

## Configuration

As much as possible, this workcell is designed to be configured declaratively. This is done with:

- Build rules and targets defined in the `Makefile` and included makefiles in the `make/` subdirectory.
- A `.env` file, generated by `make` based on configuration declared in `make/config.mk`
- The `compose.yaml` docker compose file, which defines a "stack" of containers that control your workcell
    - Note: whenever you see `${SOME_VARIABLE_NAME}` in the compose file, this value is being taken from the `.env` generated by `make`
- The `Dockerfile` in `example_app/`, which allows you to customize your experiment applications container (e.g. you can add any software or python packages that your code depends on in here)
- The Workcell Config in `workcell_defs/example_workcell.yaml`, which allows you to define WEI specific configuration for your workcell

## Building, Running, and Managing your Workcell and Experiment Application

Here are some common commands you can use to manage this workcell:

- `make build`: build the workcell, incorporating any changes as needed
- `make start`: start just the containers, but don't run the experiment application
- `make run`: run your experiment application (run `make start` first)
- `make exec`: opens a terminal inside your application container
- `make stop`: stops the workcell and any currently running applications

For a complete list of supported commands, you can run `make` or `make help`.

## Using Diaspora

To use Diaspora for logging events, you can change `USE_DIASPORA` to `true` in the `Makefile` or run `make <subcommand> USE_DIASPORA=true`
